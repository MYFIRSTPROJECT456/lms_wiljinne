<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<%- include lib/apicalh01 %>
<% var pagename="Lead list" %>

<!-- ================== BEGIN PAGE LEVEL STYLE ================== -->
<link href="assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker.css" rel="stylesheet" />
<link href="assets/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.css" rel="stylesheet" />
<link href="assets/plugins/ionRangeSlider/css/ion.rangeSlider.css" rel="stylesheet" />
<link href="assets/plugins/ionRangeSlider/css/ion.rangeSlider.skinNice.css" rel="stylesheet" />
<link href="assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" />
<link href="assets/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet" />
<link href="assets/plugins/bootstrap-eonasdan-datetimepicker/build/css/bootstrap-datetimepicker.min.css" rel="stylesheet" />
<link href="assets/plugins/DataTables/media/css/dataTables.bootstrap.min.css" rel="stylesheet" />
<link href="assets/plugins/DataTables/extensions/Buttons/css/buttons.bootstrap.min.css" rel="stylesheet" />
<link href="assets/plugins/DataTables/extensions/Scroller/css/scroller.bootstrap.min.css" rel="stylesheet" />
<link href="assets/plugins/DataTables/extensions/Responsive/css/responsive.bootstrap.min.css" rel="stylesheet" />

<!-- ================== END PAGE LEVEL STYLE ================== -->
<script>
  function startTour() {
    var tour = introJs()
    tour.setOption('tooltipPosition', 'auto');
    tour.setOption('positionPrecedence', ['left', 'right', 'bottom', 'top'])
    tour.start()
  }
</script>
<script type="text/javascript">
  var Screenfields=[];
  var currentcount=0;
  var selectedIds=[];
  var groupcount=1;
</script>

<style type="text/css">
input,textarea,select,.multipleSelect,.selectpicker,.datepicker{
 margin:0 0 10px 0;
}
.element {
  position: relative;
  top: 50%;
  transform: translateY(-10%);
}
</style>
<body>
	<!-- begin #page-loader -->
	<div id="page-loader" class="fade in"><span class="spinner"></span></div>
	<!-- end #page-loader -->
	
	<!-- begin #page-container -->
	<div id="page-container" class="fade page-sidebar-fixed page-header-fixed">
   <%- include lib/apicalh02 %>
   <!-- begin #sidebar -->
   <div id="sidebar" class="sidebar">
     <!-- begin sidebar scrollbar -->
     <div data-scrollbar="true" data-height="100%">
      <!-- begin sidebar user -->
      <ul class="nav">
       <li class="nav-profile">
        <div class="image">
         <a href="javascript:;"><img src="assets/img/user.png" alt="" /></a>
       </div>
       <div class="info">
         <%=user.enname  %>
       </div>
     </li>
   </ul>
   <!-- end sidebar user -->
   <%- include lib/apicalm01 %>
 </div>
 <!-- end sidebar scrollbar -->
</div>
<!-- end #sidebar -->

<!-- begin #content -->
<div id="content" class="content">
 <!-- begin page-header -->
 <!-- <h6 class="page-header">Lead List</h6> -->
 <!-- end page-header -->
 
 <!-- begin row -->
 <div class="row">
  <!-- begin col-12 -->
  <div class="col-md-12">
   <!-- begin panel -->
   <div class="panel panel-inverse">
    <div class="panel-heading">
      <div class="panel-heading-btn element">
        
        <a href="javascript:reset();" class="btn btn-xl btn-icon btn-circle btn-success"><i class="fa fa-refresh" ></i></a>
      </div>
      <h4 class="panel-title"><%= pagename %></h4>
    </div>
    <div class="panel-body">
      <div>
       <!-- begin row -->
       <div class="row">
        <!-- begin col-4 -->
        <div class="panel-body">
          <table id="data-table1" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Lead Name</th>
                <th>Number</th>
                <th>Email</th>
                <th>Source</th>
                <th>Address</th>
                <th>Status</th>
                <th>Assign To</th>
                <th>Lead Type</th>
              </tr>
            </thead>
            <tbody>
             
             
            </tbody>

          </table>

      <% if(user.syno != '1' ){ %>    <a class="btn btn-success btn-icon btn-circle" href="#modal-dialog1" data-toggle="modal" data-backdrop="false" style="float: right;width: 40Px;height: 40px;"><i class="fa fa-plus fa-1x" style="margin-top: 12px;" ></i></a> <%}%>

          <div class="modal fade" id="modal-dialog1">
            <div class="modal-dialog modal-lg">">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
                  <h4 class="modal-title">Lead Creation</h4>
                </div>
                <div class="modal-body">
                  <div class="row">
                    <form action="/" method="POST" id="formf" data-parsley-validate="true">
                      <%- include lib/dy/apicaldyf01.ejs %>
                    </form>
                  </div>
                </div>
                <div class="modal-footer">
                  <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal">Close</a>
                  <a href="javascript:onValidate();" class="btn btn-sm btn-success">Save</a>
                </div>    
              </div>
              
            </div>
          </div>
        </div>
        <!-- end col-4 -->

      </div>
      <!-- end row -->
      
    </div>
    <!-- end wizard step-1 -->
  </div>

</div>
</div>
<!-- end panel -->
</div>
<!-- end col-12 -->
</div>
<!-- end row -->
</div>
<!-- end #content -->
	<!-- <p class="text-center">
                            &copy; Apical Innovations All Right Reserved 2017
                          </p> -->
                          <!-- begin scroll to top btn -->
                          <a href="javascript:;" class="btn btn-icon btn-circle btn-success btn-scroll-to-top fade" data-click="scroll-top"><i class="fa fa-angle-up"></i></a>
                          <!-- end scroll to top btn -->
                          
                          <!-- ================== BEGIN BASE JS ================== -->
                          <%- include lib/apicalf02.ejs %>	
                          <!-- ================== END BASE JS ================== -->

                          <script src="assets/plugins/DataTables/media/js/jquery.dataTables.js"></script>
                          <script src="assets/plugins/DataTables/media/js/dataTables.bootstrap.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/dataTables.buttons.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/buttons.bootstrap.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/buttons.flash.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/jszip.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/pdfmake.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/vfs_fonts.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/buttons.html5.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Scroller/js/dataTables.scroller.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Buttons/js/buttons.print.min.js"></script>
                          <script src="assets/plugins/DataTables/extensions/Responsive/js/dataTables.responsive.min.js"></script>
                          <script src="assets/js/apical/table-manage-scroller.demo.js"></script>
                          <script src="assets/plugins/parsley/dist/parsley.js"></script>
                          <!-- ================== BEGIN PAGE LEVEL JS ================== -->
                          <script src="assets/js/apps.min.js"></script>
                          <!-- ================== END PAGE LEVEL JS ================== -->
                          <script type="text/javascript" src="assets/js/intro.js"></script>
                          
                          <script>
                            $(document).ready(function() {
                             App.init();
                             $( ".datepicker").datepicker();
        //             });
        
          //            $(window).load(function(e) {
         //               TableManageScroller1.init(<%= scrndtl.col2 %>);
         
         var table =   $('#data-table1').DataTable({
          dom: 'lBfrtip',
          buttons: [
          { extend: 'copy', className: 'btn-sm' },
          { extend: 'csv', className: 'btn-sm' },
          { extend: 'excel', className: 'btn-sm' },
          { extend: 'pdf', className: 'btn-sm' },
          { extend: 'print', className: 'btn-sm' }
          ],
          
          ajax: {
            "url": "/scrndata?id="+<%- scrndtl.col2 %>,
            "dataType": "JSON"
          },
          "language": {
            "emptyTable":     "No record found"
          },
          responsive: true,
          'rowCallback': function(row, data, index){
              <% if (user.syno != '1'){ %>
               $(row).addClass('hover');
            <% } %>
              $(row).attr('id', data[11]);
            if(data[7] ==  "Hot"){
              $(row).find('td').css('background-color', '#ffcccc').css('font-weight', 'bold');
            }
            else if(data[7] == 'Warm'){
              $(row).find('td').css('background-color', '#ffd1b3').css('font-weight', 'bold');
            }
	else if(data[7] == 'Cold'){
              $(row).find('td').css('background-color', '#e6f0ff').css('font-weight', 'bold');
            }
	else{
              $(row).find('td').css('font-weight', 'bold');
            }

         }
       });

         $('#data-table1 tbody').on('click', 'tr', function () {
              <% if(user.syno == '1'){%><%}else{%>         
           var data1 = this.id;
           document.getElementById('lval').value=data1;
           var form = $('#lform');
           form.attr('action', '/historydata');
           form.attr('method', 'POST');
           form.submit();
             <% }%>
             
         });
       });

                            function reset() {
                       // document.getElementById("form1").reset();
                       $('#data-table1').DataTable().ajax.reload();
                     };
                   </script>


                   <script>
                     function onValidate() {
                     //   alert("funcntion called");
                     /*    var scrno = '555';*/
                     var form = $('#formf');
                     form.parsley().validate();
                     if (form.parsley().isValid()) {
//                            alert('valid');
var formdata = $('#formf').serializeArray();

                            //structure json
                            var data = formdata.reduce(function(a, x) {
                              a[x.name] = x.value;
                              return a;
                            }, {});
                            Screenfields.push(data);
                         //   alert(JSON.stringify(Screenfields));
                         $.ajax({
                          type: "POST",
                          url: "/savedata",
                          timeout: 2000,
                          contentType: 'application/json',
                          data: JSON.stringify({
                            scrid: "575",
                            formdata: JSON.stringify(Screenfields)
                          }),
                          success: function(data) {
                            var fdata = JSON.parse(JSON.stringify(data));
                            if (fdata.status == '1') {
                              Screenfields = [];
                              alert("Data saved successfully");
                              $('#formf').trigger("reset");
                              $('#modal-dialog1').modal('hide');
                            } else {
                             alert(fdata.err_msg);
                             Screenfields = [];
                           }
                         }

                       });
                       } else {
                        alert(' not valid');
                      }
                    };
                  </script>
                  <script type="text/javascript">
                    
                    $('#modal-dialog1').on('show.bs.modal', function(e) {
                      $('select').each(
                        function(index){  
                          var input = $(this);
                          var api=input.attr('api');
                          /*alert('Api: ' + input.attr('api'));*/
                          $.ajax({
                            type: "GET",
                            url: ""+api,
                            timeout: 2000,
                            contentType: 'application/json',
                            success: function(data)
                            {
                              helpers.buildDropdown(
                                JSON.parse(JSON.stringify(data)),
                                input,
                                'Select an option'
                                );
                            }
                          });
                          
                        });

                    });

                  </script>
                </body>
                </html>

